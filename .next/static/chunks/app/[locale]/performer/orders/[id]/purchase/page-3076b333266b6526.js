(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[104],{1389:(e,t,r)=>{Promise.resolve().then(r.bind(r,6185))},1847:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var s=r(2115);let a=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=(0,s.forwardRef)((e,t)=>{let{color:r="currentColor",size:n=24,strokeWidth:l=2,absoluteStrokeWidth:c,className:d="",children:o,iconNode:m,...x}=e;return(0,s.createElement)("svg",{ref:t,...i,width:n,height:n,stroke:r,strokeWidth:c?24*Number(l)/Number(n):l,className:a("lucide",d),...x},[...m.map(e=>{let[t,r]=e;return(0,s.createElement)(t,r)}),...Array.isArray(o)?o:[o]])}),l=(e,t)=>{let r=(0,s.forwardRef)((r,i)=>{let{className:l,...c}=r;return(0,s.createElement)(n,{ref:i,iconNode:t,className:a("lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),l),...c})});return r.displayName="".concat(e),r}},6185:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var s=r(5155),a=r(2115),i=r(63),n=r(8525),l=r(5604),c=r(9708);let d=(0,r(1847).A)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);function o(){let e=(0,i.useParams)(),t=(0,i.useRouter)(),r=(0,l.useLocale)(),o=e.id,m=(0,n.U)(),[x,u]=(0,a.useState)(null),[p,h]=(0,a.useState)(!0),[f,y]=(0,a.useState)(!1);(0,a.useEffect)(()=>{o&&N()},[o]);let N=async()=>{let{data:{user:e}}=await m.auth.getUser();if(!e)return void t.push("/".concat(r,"/login"));let{data:s,error:a}=await m.from("orders").select("*").eq("id",o).single();if(a){console.error("Error loading order:",a),h(!1);return}let{data:i}=await m.from("offers").select("status").eq("order_id",o).eq("performer_id",e.id).single();if(!i||"accepted"!==i.status)return void t.push("/".concat(r,"/orders/").concat(o));u(s),h(!1)},j=async()=>{y(!0);let{data:{user:e}}=await m.auth.getUser();if(!e)return void t.push("/".concat(r,"/login"));let{data:s}=await m.from("contact_purchases").select("*").eq("order_id",o).eq("performer_id",e.id).eq("status","completed").single();if(s)return void t.push("/".concat(r,"/orders/").concat(o));let a=await fetch("/api/stripe/create-payment-intent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:o,amount:500,locale:r})}),{checkoutUrl:i,error:n}=await a.json();if(n||!i){alert(n||"Ошибка при создании платежа"),y(!1);return}window.location.href=i};return p?(0,s.jsx)("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:(0,s.jsx)("p",{children:"Загрузка..."})}):x?(0,s.jsx)("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:(0,s.jsxs)("div",{className:"card",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center",children:(0,s.jsx)(c.A,{className:"w-8 h-8 text-primary"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Получить контакты заказчика"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Чтобы связаться с заказчиком, необходимо оплатить доступ к контактам"})]})]}),(0,s.jsxs)("div",{className:"border-t border-gray-200 pt-6 mb-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Информация о заказе"}),(0,s.jsxs)("div",{className:"space-y-2 text-gray-700",children:[(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Название:"})," ",x.title]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Описание:"})," ",x.description]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Местоположение:"})," ",x.location]}),x.budget&&(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Бюджет:"})," ",x.budget,"€"]})]})]}),(0,s.jsxs)("div",{className:"border-t border-gray-200 pt-6 mb-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsx)("span",{className:"text-gray-700",children:"Стоимость доступа к контактам"}),(0,s.jsxs)("span",{className:"text-2xl font-bold text-primary",children:[5,"€"]})]}),(0,s.jsx)("p",{className:"text-sm text-gray-500 mb-6",children:"После оплаты вы получите доступ к контактным данным заказчика и сможете связаться с ним напрямую."})]}),(0,s.jsxs)("button",{onClick:j,disabled:f,className:"btn-primary w-full flex items-center justify-center gap-2",children:[(0,s.jsx)(d,{className:"w-5 h-5"}),f?"Обработка...":"Оплатить ".concat(5,"€")]})]})}):(0,s.jsx)("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:(0,s.jsx)("p",{children:"Заказ не найден"})})}},8525:(e,t,r)=>{"use strict";r.d(t,{U:()=>a});var s=r(5890);function a(){let e="https://rdlrzuyqbtxcszzcdtge.supabase.co",t="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJkbHJ6dXlxYnR4Y3N6emNkdGdlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY1ODE5OTMsImV4cCI6MjA4MjE1Nzk5M30.xqYNOx2JD1vQrrEob6HYJlOm5w82oMi3Hv604QLgWGY";if(!e||!t)return console.error("Supabase environment variables not configured. Please set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY"),(0,s.createBrowserClient)(e||"https://placeholder.supabase.co",t||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZS1kZW1vIiwicm9sZSI6ImFub24iLCJleHAiOjE5ODM4MTI5OTZ9.CRXP1A7WOeoJeXxjNni43kdQwgnWNReilDMblYTn_I0");try{return(0,s.createBrowserClient)(e,t)}catch(e){return console.error("Error creating Supabase client:",e),(0,s.createBrowserClient)("https://placeholder.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZS1kZW1vIiwicm9sZSI6ImFub24iLCJleHAiOjE5ODM4MTI5OTZ9.CRXP1A7WOeoJeXxjNni43kdQwgnWNReilDMblYTn_I0")}}},9708:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(1847).A)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])}},e=>{e.O(0,[223,890,441,255,358],()=>e(e.s=1389)),_N_E=e.O()}]);