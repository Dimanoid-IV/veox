(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[853],{1847:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var s=r(2115);let a=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let c=(0,s.forwardRef)((e,t)=>{let{color:r="currentColor",size:c=24,strokeWidth:n=2,absoluteStrokeWidth:l,className:o="",children:d,iconNode:m,...u}=e;return(0,s.createElement)("svg",{ref:t,...i,width:c,height:c,stroke:r,strokeWidth:l?24*Number(n)/Number(c):n,className:a("lucide",o),...u},[...m.map(e=>{let[t,r]=e;return(0,s.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),n=(e,t)=>{let r=(0,s.forwardRef)((r,i)=>{let{className:n,...l}=r;return(0,s.createElement)(c,{ref:i,iconNode:t,className:a("lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),n),...l})});return r.displayName="".concat(e),r}},2529:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(1847).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},3748:(e,t,r)=>{Promise.resolve().then(r.bind(r,4689))},4689:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var s=r(5155),a=r(2115),i=r(63),c=r(8525),n=r(5604),l=r(2529);function o(){let e=(0,i.useParams)(),t=(0,i.useSearchParams)(),r=(0,i.useRouter)(),o=(0,n.useLocale)(),d=e.id;t.get("payment_intent");let m=(0,c.U)(),[u,p]=(0,a.useState)(!0),[x,h]=(0,a.useState)(!1);(0,a.useEffect)(()=>{I()},[]);let I=async()=>{let{data:{user:e}}=await m.auth.getUser();if(!e)return void r.push("/".concat(o,"/login"));let s=t.get("session_id"),{data:a,error:i}=await m.from("contact_purchases").select("*").eq("order_id",d).eq("performer_id",e.id).or(s?"stripe_checkout_session_id.eq.".concat(s,",status.eq.completed"):"status.eq.completed").single();a&&"completed"===a.status?h(!0):a&&"pending"===a.status?setTimeout(()=>I(),2e3):console.error("Payment verification failed:",i),p(!1)};return u?(0,s.jsx)("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:(0,s.jsx)("div",{className:"card text-center",children:(0,s.jsx)("p",{children:"Проверка платежа..."})})}):x?(0,s.jsx)("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:(0,s.jsxs)("div",{className:"card text-center",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,s.jsx)(l.A,{className:"w-10 h-10 text-green-600"})}),(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Платеж успешен!"}),(0,s.jsx)("p",{className:"text-gray-600 mb-8",children:"Теперь у вас есть доступ к контактным данным заказчика."}),(0,s.jsx)("button",{onClick:()=>r.push("/".concat(o,"/orders/").concat(d)),className:"btn-primary",children:"Просмотреть контакты"})]})}):(0,s.jsx)("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:(0,s.jsxs)("div",{className:"card text-center",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Платеж обрабатывается"}),(0,s.jsx)("p",{className:"text-gray-600 mb-6",children:"Ваш платеж обрабатывается. Пожалуйста, подождите..."}),(0,s.jsx)("button",{onClick:()=>r.push("/".concat(o,"/performer/orders")),className:"btn-primary",children:"Вернуться к заказам"})]})})}},8525:(e,t,r)=>{"use strict";r.d(t,{U:()=>a});var s=r(5890);function a(){let e="https://rdlrzuyqbtxcszzcdtge.supabase.co",t="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJkbHJ6dXlxYnR4Y3N6emNkdGdlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY1ODE5OTMsImV4cCI6MjA4MjE1Nzk5M30.xqYNOx2JD1vQrrEob6HYJlOm5w82oMi3Hv604QLgWGY";if(!e||!t)return console.error("Supabase environment variables not configured. Please set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY"),(0,s.createBrowserClient)(e||"https://placeholder.supabase.co",t||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZS1kZW1vIiwicm9sZSI6ImFub24iLCJleHAiOjE5ODM4MTI5OTZ9.CRXP1A7WOeoJeXxjNni43kdQwgnWNReilDMblYTn_I0");try{return(0,s.createBrowserClient)(e,t)}catch(e){return console.error("Error creating Supabase client:",e),(0,s.createBrowserClient)("https://placeholder.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZS1kZW1vIiwicm9sZSI6ImFub24iLCJleHAiOjE5ODM4MTI5OTZ9.CRXP1A7WOeoJeXxjNni43kdQwgnWNReilDMblYTn_I0")}}}},e=>{e.O(0,[223,890,441,255,358],()=>e(e.s=3748)),_N_E=e.O()}]);